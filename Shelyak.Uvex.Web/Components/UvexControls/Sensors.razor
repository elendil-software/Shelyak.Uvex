@using Shelyak.Uvex.Web.Extensions
@inherits UvexComponentBase
@rendermode InteractiveServer
@inject IStringLocalizer<LocalizationResources> Loc;

<Card Class="h-100">
    <CardBody>
        <CardTitle>@Loc["UvexControl_Sensors_CardTitle"]</CardTitle>

        <ErrorCallout ErrorMessage="@ErrorMessage" />
        
        <dl class="row">
            <dt class="col-12 col-lg-6">@Loc["UvexControl_Sensors_Label_Temperature"]</dt>
            <dd class="col-12 col-lg-6">@CurrentTemperature °C</dd>
        </dl>
    </CardBody>
</Card>

@code
{
    private float CurrentTemperature { get; set; }
  
    protected override async Task OnInitializedAsync()
    {
        await LoadData();
        await base.OnInitializedAsync();
    }
    
    protected override async Task LoadData()
    {
        var result = await ExecuteAndHandleError(async () => await AlpacaCommands.GetTemperature());
        if (result.IsSuccessAndHasValue())
        {
            CurrentTemperature = result.Value.Value!.Value;
        }
    }
}
